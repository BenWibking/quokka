<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Installation - Quokka</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Installation";
        var mkdocs_page_input_path = "installation.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Quokka
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../equations/">Equations</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../citation/">Citation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">User guide</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Installation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#building-with-cmake-make">Building with CMake + make</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#could-not-find-python-error">Could NOT find Python error</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#running-on-gpus">Running on GPUs</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#nvidia-gpus">NVIDIA GPUs</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#amd-gpus-experimental-use-at-your-own-risk">AMD GPUs (experimental, use at your own risk)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#intel-gpus-does-not-compile">Intel GPUs (does not compile)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#building-a-specific-test-problem">Building a specific test problem</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../running_on_hpc_clusters/">Running on HPC clusters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tests/">Test problems</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parameters/">Runtime parameters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../insitu_analysis/">In-situ analysis</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../postprocessing/">Postprocessing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../instability/">Debugging simulation instability</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Test problems</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tests/radshock/">Radiative shock test</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tests/shu_osher/">Shu-Osher shock test</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tests/sms/">Slow-moving shock test</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tests/energy_exchange/">Matter-radiation temperature equilibrium test</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tests/radhydro_uniform_adv/">Uniform advecting radiation in diffusive limit</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPER GUIDE</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../flowchart/">Flowchart</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../debugging/">Debugging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../error_checking/">Assertions and error checking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../performance/">Performance tips</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../howto_clang_tidy/">How to use clang-tidy</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Quokka</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">User guide</li>
      <li class="breadcrumb-item active">Installation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="installation">Installation</h1>
<p>To run Quokka, download this repository and its submodules to your local machine:</p>
<pre><code>git clone --recursive https://github.com/quokka-astro/quokka.git
</code></pre>
<p>Quokka uses CMake (and optionally, Ninja) as its build system. If you don't have CMake and Ninja installed, the easiest way to install them is to run:</p>
<pre><code>python3 -m pip install cmake ninja --user
</code></pre>
<p>Now that CMake is installed, create a <code>build/</code> subdirectory and compile Quokka, as shown below.</p>
<pre><code>cd quokka
mkdir build; cd build
cmake .. -DCMAKE_BUILD_TYPE=Release -G Ninja
ninja -j6
</code></pre>
<p>Congratuations! You have now built all of the 1D test problems on CPU. You can run the automated test suite:</p>
<pre><code>ninja test
</code></pre>
<p>You should see output that indicates all tests have passed, like this:</p>
<pre><code>100% tests passed, 0 tests failed out of 20

Total Test time (real) = 111.74 sec
</code></pre>
<p>To run in 2D or 3D, build with the <code>-DAMReX_SPACEDIM</code> CMake option, for example:</p>
<pre><code>cmake .. -DCMAKE_BUILD_TYPE=Release -DAMReX_SPACEDIM=3 -G Ninja
ninja -j6
</code></pre>
<p>to compile Quokka for 3D problems.</p>
<p><strong>By default, Quokka compiles itself only for CPUs. If you want to run Quokka on GPUs, see the section "Running on GPUs" below.</strong></p>
<p>Have fun!</p>
<h2 id="building-with-cmake-make">Building with CMake + <code>make</code></h2>
<p>If you are unable to install Ninja, you can instead use CMake with the Makefile generator, which should produce identical results but is slower:</p>
<pre><code>cmake .. -DCMAKE_BUILD_TYPE=Release -G "Unix Makefiles"
make -j6
make test
</code></pre>
<h2 id="could-not-find-python-error">Could NOT find Python error</h2>
<p>If CMake prints an error saying that Python could not be found, e.g.:</p>
<pre><code>-- Could NOT find Python (missing: Python_EXECUTABLE Python_INCLUDE_DIRS Python_LIBRARIES Python_NumPy_INCLUDE_DIRS Interpreter Development NumPy Development.Module Development.Embed)
</code></pre>
<p>you should be able to fix this by installing NumPy (and matplotlib) by running</p>
<pre><code>python3 -m pip install numpy matplotlib --user
</code></pre>
<p>This should enable CMake to find the NumPy header files that are needed to successfully compile.</p>
<p>Alternatively, you can work around this problem by disabling Python support. Python and NumPy are only used to plot the results of some test problems, so this does not otherwise affect Quokka's functionality. Add the option</p>
<pre><code>-DQUOKKA_PYTHON=OFF
</code></pre>
<p>to the CMake command-line options (or change the <code>QUOKKA_PYTHON</code> option to <code>OFF</code> in CMakeLists.txt).</p>
<h2 id="running-on-gpus">Running on GPUs</h2>
<p>By default, Quokka compiles itself to run only on CPUs. Quokka can run on either NVIDIA or AMD GPUs. Consult the sub-sections below for the build instructions for a given GPU vendor.</p>
<h3 id="nvidia-gpus">NVIDIA GPUs</h3>
<p>If you want to run on NVIDIA GPUs, re-build Quokka as shown below. (<em>CUDA &gt;= 11.7 is required. Quokka is only supported on Volta V100 GPUs or newer models. Your MPI library</em> <strong>must</strong> <em>support CUDA-aware MPI.</em>)</p>
<pre><code>cmake .. -DCMAKE_BUILD_TYPE=Release -DAMReX_GPU_BACKEND=CUDA -DAMReX_SPACEDIM=3 -G Ninja
ninja -j6
</code></pre>
<p><strong>All GPUs on a node must be visible from each MPI rank on the node for efficient GPU-aware MPI communication to take place via CUDA IPC.</strong> When using the SLURM job scheduler, this means that <code>--gpu-bind</code> should be set to <code>none</code>.</p>
<p>The compiled test problems are in the test problem subdirectories in <code>build/src/</code>. Example scripts for running Quokka on compute clusters are in the <code>scripts/</code> subdirectory.</p>
<p>Note that 1D problems can run very slowly on GPUs due to a lack of sufficient parallelism. To run the test suite in a reasonable amount of time, you may wish to exclude the matter-energy exchange tests, e.g.:</p>
<pre><code>ctest -E "MatterEnergyExchange*"
</code></pre>
<p>which should end with output similar to the following:</p>
<pre><code>100% tests passed, 0 tests failed out of 18

Total Test time (real) = 353.77 sec
</code></pre>
<h3 id="amd-gpus-experimental-use-at-your-own-risk">AMD GPUs <em>(experimental, use at your own risk)</em></h3>
<p>Compile with <code>-DAMReX_GPU_BACKEND=HIP</code>. Requires ROCm 5.2.0 or newer. Your MPI library <strong>must</strong> support GPU-aware MPI for AMD GPUs. Quokka has been tested on MI100 and MI250X GPUs, but there are known compiler issues that affect the correctness of simulation results (see <a href="https://github.com/quokka-astro/quokka/issues/394">https://github.com/quokka-astro/quokka/issues/394</a> and <a href="https://github.com/quokka-astro/quokka/issues/447">https://github.com/quokka-astro/quokka/issues/447</a>).</p>
<h3 id="intel-gpus-does-not-compile">Intel GPUs <em>(does not compile)</em></h3>
<p>Due to limitations in the Intel GPU programming model, Quokka currently cannot be compiled for Intel GPUs. (See <a href="https://github.com/quokka-astro/quokka/issues/619">https://github.com/quokka-astro/quokka/issues/619</a> for the technical details.)</p>
<h2 id="building-a-specific-test-problem">Building a specific test problem</h2>
<p>By default, all available test problems will be compiled. If you only want to build a specific problem, you can list all of the available CMake targets:</p>
<pre><code>cmake --build . --target help
</code></pre>
<p>and then build the problem of interest:</p>
<pre><code>ninja -j6 test_hydro3d_blast
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../citation/" class="btn btn-neutral float-left" title="Citation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../running_on_hpc_clusters/" class="btn btn-neutral float-right" title="Running on HPC clusters">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>© Copyright 2020-2024, Ben Wibking and Quokka Developers.</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../citation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../running_on_hpc_clusters/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../javascripts/mathjax.js"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
